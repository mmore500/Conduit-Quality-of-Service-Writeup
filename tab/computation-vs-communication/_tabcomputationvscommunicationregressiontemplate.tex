\input{lib/importpath.tex}
\input{lib/replacesinglequote.tex}
\input{tab/_rotcolmacro.tex}

% adapted from https://tex.stackexchange.com/a/63592
% and https://tex.stackexchange.com/a/196773
% and https://tex.stackexchange.com/a/422586
% and https://tex.stackexchange.com/a/602970
% and https://tex.stackexchange.com/q/420133
% and https://tex.stackexchange.com/a/62443
% and https://tex.stackexchange.com/a/32690

\clearpage
\onecolumn

\begin{landscape}

\csvstyle{myTableStyle}{
  longtable=@{\hspace{-.5\arrayrulewidth}}c@{\hspace{-.5\arrayrulewidth}}|l|l|l|l|l|l|l|l|l|l|l|l|l|l|,
  table head=\caption{
    Full \regression{} results of  quality of service metrics against log computational intensity for computation vs. communication experiment (Section \ref{sec:computation-vs-communication}).
    Significance level $p < 0.05$ used.
    Inf or NaN values may occur due to multicollinearity or due to inf or NaN observations.
    }\label{tab:computation-vs-communication-\regressionslug} \\
    \toprule%
    \multicolumn{1}{@{\hspace{-.5\arrayrulewidth}}l@{\hspace{-.5\arrayrulewidth}}}{} &%
    \rotcol{ Metric } &%
    \rotcol{ Statistic } &%
    \rotcol{ Significant Effect Sign } &%
    \rotcol{ Cpus Per Node } &%
    \rotcol{ Num Simels Per Cpu} &%
    \rotcol{ Num Processes} &%
    \rotcol{ Absolute Effect Size} &%
    \rotcol{ Absolute Effect Size 95\% CI Lower Bound} &%
    \rotcol{ Absolute Effect Size 95\% CI Upper Bound} &%
    \rotcol{ Relative Effect Size} &%
    \rotcol{ Relative Effect Size 95\% CI Lower Bound} &%
    \rotcol{ Relative Effect Size 95\% CI Upper Bound} &%
    \rotcol{$\mathbf{n}$} & %
    \rotcol{$\mathbf{p}$} %
    \vspace{-1ex} \\ \midrule\endhead
    \bottomrule\endfoot,
  late after line=\\\hline,
  late after last line=\\\bottomrule,
  head to column names,
  filter=\equal{\csuse{RegressionModelSlug}}{\regressionslug},
}

% pass an arbitrary filename, potentially with unsafe characters
% adapted from https://tex.stackexchange.com/a/36178
\catcode`\%=12
\providecommand\filename{}
\renewcommand\filename{\detokenize{submodule/conduit-binder/binder/date=2021+project=72k5n/a=computation-vs-communication/outplots/a=computation_vs_communication_regression_results+async_mode=3+comp_work=0-64%64_4096_262144_16777216+impl=proc+nproc=2+nthread=1+proc=0-1+readability=latexcsvreader+replicate=0-9+slurm_nnodes=2+slurm_ntasks=2+subject=inlet~outlet+view=summary+ext=.csv}}
\catcode`\%=14

\csvreader[myTableStyle]{\importpath\filename}{}%
{ %
  &%
  \csuse{DependentVariable} &%
  \csuse{Statistic} &%
  \ifthenelse{\equal{\csuse{SignificantEffectSign}}{-}}{\cellcolor{red!25}}{}%
  \ifthenelse{\equal{\csuse{SignificantEffectSign}}{+}}{\cellcolor{green!25}}{}%
  \ifthenelse{\equal{\csuse{SignificantEffectSign}}{0}}{\cellcolor{gray!25}}{}%
  \csuse{SignificantEffectSign} &%
  \replacesinglequote{\csuse{CpusPerNode}} &%
  \replacesinglequote{\csuse{NumSimelsPerCpu}} &%
  \replacesinglequote{\csuse{NumProcessesPrettyprint}} &%
  \replacesinglequote{\csuse{AbsoluteEffectSize}} &%
  \replacesinglequote{\csuse{AbsoluteEffectSize95CILowerBound}} &%
  \replacesinglequote{\csuse{AbsoluteEffectSize95CIUpperBound}} &%
  \replacesinglequote{\csuse{RelativeEffectSize}} &%
  \replacesinglequote{\csuse{RelativeEffectSize95CILowerBound}} &%
  \replacesinglequote{\csuse{RelativeEffectSize95CIUpperBound}} &%
  \replacesinglequote{\csuse{n}} &%
  \replacesinglequote{\csuse{p}} %
}

\end{landscape}

\clearpage
\twocolumn
